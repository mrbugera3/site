<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bubble Game</title>

<style>
body{
  margin:0;
  background:#111;
  overflow:hidden;
}
canvas{
  display:block;
}
#ui{
  position:fixed;
  top:10px;
  left:10px;
  color:white;
  font-size:18px;
  font-family:Arial;
}
#gameover{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  color:white;
  text-align:center;
  display:none;
}
button{
  padding:12px 25px;
  font-size:18px;
}
</style>
</head>
<body>

<div id="ui">Score: <span id="score">0</span></div>

<div id="gameover">
<h1>Game Over</h1>
<button onclick="restart()">Restart</button>
</div>

<canvas id="c"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");
const scoreEl = document.getElementById("score");
const gameoverEl = document.getElementById("gameover");

let w, h;
function resize(){
  w = c.width = window.innerWidth;
  h = c.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

let player, bullets, bubbles, score, gameOver;

function init(){
  player = {x:w/2, y:h-50, w:30, h:20};
  bullets = [];
  bubbles = [{x:w/2, y:100, r:40, dx:3, dy:2}];
  score = 0;
  gameOver = false;
  scoreEl.textContent = score;
  gameoverEl.style.display = "none";
}

// touch & mouse control
function movePlayer(x){
  player.x = x;
  player.x = Math.max(20, Math.min(w-20, player.x));
}

document.addEventListener("mousemove",e=>{
  movePlayer(e.clientX);
});

c.addEventListener("touchmove", e=>{
  e.preventDefault();
  movePlayer(e.touches[0].clientX);
},{passive:false});

// auto shooting
setInterval(()=>{
  if(!gameOver){
    bullets.push({x:player.x, y:player.y});
  }
},400);

function splitBubble(b){
  if(b.r > 15){
    bubbles.push({x:b.x, y:b.y, r:b.r/2, dx:-3, dy:-3});
    bubbles.push({x:b.x, y:b.y, r:b.r/2, dx:3, dy:-3});
  }
}

function loop(){
  ctx.clearRect(0,0,w,h);
  if(gameOver) return;

  // player
  ctx.fillStyle="lime";
  ctx.fillRect(player.x-15,player.y,30,20);

  // bullets
  bullets.forEach(b=>b.y-=8);
  bullets = bullets.filter(b=>b.y>0);
  ctx.fillStyle="white";
  bullets.forEach(b=>ctx.fillRect(b.x-2,b.y,4,12));

  // bubbles
  ctx.fillStyle="red";
  bubbles.forEach(b=>{
    b.x+=b.dx;
    b.y+=b.dy;
    b.dy+=0.2;

    if(b.x-b.r<0||b.x+b.r>w) b.dx*=-1;
    if(b.y+b.r>h) b.dy=-Math.abs(b.dy);

    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();

    // collision with player
    const dx=player.x-b.x;
    const dy=player.y-b.y;
    if(Math.sqrt(dx*dx+dy*dy)<b.r){
      endGame();
    }
  });

  // bullet collisions
  bullets.forEach(b=>{
    bubbles.forEach(bu=>{
      const dx=b.x-bu.x;
      const dy=b.y-bu.y;
      if(Math.sqrt(dx*dx+dy*dy)<bu.r){
        bu.dead=true;
        b.dead=true;
        score+=10;
        scoreEl.textContent=score;
        splitBubble(bu);
      }
    });
  });

  bullets=bullets.filter(b=>!b.dead);
  bubbles=bubbles.filter(b=>!b.dead);

  if(bubbles.length===0){
    bubbles.push({x:w/2,y:80,r:50,dx:3,dy:2});
  }

  requestAnimationFrame(loop);
}

function endGame(){
  gameOver=true;
  gameoverEl.style.display="block";
}

function restart(){
  init();
  loop();
}

init();
loop();
</script>

</body>
</html>
